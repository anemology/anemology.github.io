<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
<title>Hexo 及 NexT 主題升級紀錄</title>
<meta name="description" 
      content=""
>

  




<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link
  rel="alternate"
  type="application/rss+xml"
  href="https://anemology.cc/index.xml"
  title="翱翔在空中"
/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hexo 及 NexT 主題升級紀錄"/>
<meta name="twitter:description" content="從去年開始， GitHub 的 dependabot 就會自動偵測 repositories 內 npm 使用的相依套件，如果有安全性問題，bot 就會自動通知並發起 pull request，提醒要更新。
因我的部落格也很久沒更新了，索性就一次將 Hexo 及 NexT 的主題一起更新到最新版，順便紀錄一下作法方便之後再更新。

Hexo 3.8.0 -&gt; 4.2.1
NexT 5.1.3 -&gt; 7.8.0
"/>



<link rel="stylesheet" href="https://anemology.cc/fontawesome/css/all.min.css" />




<link
  crossorigin="anonymous"
  href="/css/styles.min.css"
  integrity=""
  rel="preload stylesheet"
  as="style"
/>


  <link rel="stylesheet" href="https://anemology.cc/css/custom.css" />



<link
  id="dark-mode-theme"
  crossorigin="anonymous"
  href="/css/dark.min.css"
  integrity=""
  rel="preload stylesheet"
  as="style"
/>


<script>
  var darkTheme = document.getElementById('dark-mode-theme')
  var storedTheme = localStorage.getItem('dark-mode-storage')

  if (storedTheme === 'dark') {
    darkTheme.disabled = false
  } else if (storedTheme === 'light') {
    darkTheme.disabled = true
  }
</script>


<script defer crossorigin="anonymous" src="/js/theme.js" integrity=""></script>


<script defer crossorigin="anonymous" src="/js/instantpage.min.js" integrity=""></script><meta name="generator" content="Hugo 0.98.0" />
  </head>
  <body>
    
  




  <header>
    <nav class="navbar">
  <div class="nav">
    

    <ul class="nav-links">
      
        
          <li>
            <a href="/tags" id="Tags"
              ><em class="fas fa-tag fa-lg"></em
            ></a>
          </li>
          
      
        
          <li>
            <a href="/search" id="Search"
              ><em class="fas fa-search fa-lg"></em
            ></a>
          </li>
          
      
        
          <li>
            <a href="/archives" id="Archives"
              ><em class="fas fa-archive fa-lg"></em
            ></a>
          </li>
          
      
    </ul>
  </div>
</nav>

    <div class="intro-header">
      <div class="container">
        <div class="post-heading">
          
            <h1>
              Hexo 及 NexT 主題升級紀錄
            </h1>
          
          
            <span class="meta-post">
  <em class="fa fa-calendar-alt"></em
  >&nbsp;July 19, 2020
  
    &nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
    
      <a
        href="https://anemology.cc/categories/%E9%83%A8%E8%90%BD%E6%A0%BC/"
        >部落格</a
      >&nbsp;
    
  
</span>

          
        </div>
      </div>
    </div>
  </header>
  

    
  <div class="container" role="main">
    <article class="article" class="blog-post">
      
  <p>從去年開始， GitHub 的 <a href="https://github.com/apps/dependabot">dependabot</a> 就會自動偵測 repositories 內 npm 使用的相依套件，如果有安全性問題，bot 就會自動通知並發起 pull request，提醒要更新。</p>
<p>因我的部落格也很久沒更新了，索性就一次將 <a href="https://github.com/hexojs/hexo">Hexo</a> 及 <a href="https://github.com/next-theme/hexo-theme-next">NexT</a> 的主題一起更新到最新版，順便紀錄一下作法方便之後再更新。</p>
<ul>
<li>Hexo <code>3.8.0</code> -&gt; <code>4.2.1</code></li>
<li>NexT <code>5.1.3</code> -&gt; <code>7.8.0</code></li>
</ul>
<p>大版本更新通常會有 breaking changes，更新後發現有不少問題，因 config 自訂的地方也不多，決定整個打掉重練。</p>
<h2 id="步驟">步驟</h2>
<ol>
<li>
<p>建一個全空的 hexo 部落格</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 更新 hexo-cli</span>
</span></span><span style="display:flex;"><span>npm install hexo-cli -g
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 初始化 hexo 至 update_blog 資料夾</span>
</span></span><span style="display:flex;"><span>hexo init update_blog
</span></span><span style="display:flex;"><span>cd update_blog
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 安裝部署使用的套件 hexo-deployer-git</span>
</span></span><span style="display:flex;"><span>npm install hexo-deployer-git
</span></span></code></pre></div></li>
<li>
<p>打開 blog 資料夾底下的 <code>package.json</code>，確認 hexo 版本 (<code>&quot;hexo&quot;: &quot;^4.2.1&quot;</code>)</p>
</li>
<li>
<p>將原本部落格資料夾內的 <code>scaffolds</code>、<code>source</code> 資料夾複製到 <code>update_blog</code> 內</p>
</li>
<li>
<p>將原本部落格資料夾內的 <code>themes/next</code> 資料夾複製到相對應之路徑</p>
</li>
<li>
<p>刪除沒有用到的預設主題 <code>themes/landscape</code></p>
</li>
<li>
<p>下載最新的 NexT 主題</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd update_blog
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 因這邊要保留原本舊的 next 主題，所以將新版主題放到不同資料夾</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/theme-next/hexo-theme-next themes/hexo-theme-next
</span></span></code></pre></div></li>
<li>
<p>調整設定檔，這邊都直接使用新版的 yml 檔案</p>
<ol>
<li>比對新舊 <code>_config.yml</code>，有 <a href="https://github.com/anemology/anemology.github.io/blob/7305473a75e8ce6cd38e96adfdfe0311cbd21bbb/_config.yml#L6">調整過的設定</a> 我用 <code>#@~@</code> 註記起來，以後比較好找</li>
</ol>
</li>
<li>
<p>調整主題設定檔</p>
<ol>
<li>比對 <code>themes\hexo-theme-next\_config.yml</code> 和 <code>themes\next\_config.yml</code>，將有調整過的設定改寫至根目錄底下 <code>_config.yml</code> 的 <code>theme_config:</code> <a href="https://github.com/anemology/anemology.github.io/blob/7305473a75e8ce6cd38e96adfdfe0311cbd21bbb/_config.yml#L107">區塊</a>
好處是主題內的設定檔就維持預設的樣子，以後可以整個資料夾更新，統一在同個設定檔案也比較好維護</li>
<li>另外 <a href="https://github.com/theme-next/hexo-theme-next/blob/master/docs/DATA-FILES.md">NexT 文件</a> 內有提到，也可以將設定寫到 <code>source/_data/next.yml</code>，就看個人選擇</li>
</ol>
</li>
<li>
<p>完成之後可以在本機下 <code>hexo server</code>，看一下有無問題</p>
</li>
<li>
<p>最後就可以將變更 push 到遠端 hexo 分支，<a href="/post/setup-travis-ci-for-hexo-on-github/">之前設定的 Travis CI</a> 就會自動幫我們部署到 GitHub Pages 啦~</p>
</li>
</ol>
<h2 id="其他">其他</h2>
<ul>
<li>去掉 post 內的 <code>updated</code> 日期，之後有更新再寫就好，<a href="/post/next-edit-time/">Next 主題修改更新時間的顯示規則</a> 就不用了
不確定這是新版還是舊版 NexT 行為，現在預設是 <code>date</code> 與 <code>updated</code> 不同天，才會顯示更新時間，可以參考 <a href="https://github.com/theme-next/hexo-theme-next/commit/9f4f0143aff6e7e804e3396f33acdcf9a109efd0">another_day 設定</a></li>
<li>可以看一下 <code>_config.yml</code> 的 <a href="https://github.com/anemology/anemology.github.io/blob/7305473a75e8ce6cd38e96adfdfe0311cbd21bbb/_config.yml">commit 紀錄</a>，會比較清楚</li>
</ul>
<h2 id="參考網址">參考網址</h2>
<p><a href="https://github.com/theme-next/hexo-theme-next/blob/master/docs/UPDATE-FROM-5.1.X.md">Update from NexT v5.1.x</a></p>
<hr>
<ul>
<li><code>npm</code> version <code>6.9.0</code></li>
<li><code>Hexo</code> version <code>4.2.1</code></li>
<li><code>NexT</code> version <code>7.8.0</code></li>
<li><code>git</code> version <code>2.22.0.windows.1</code></li>
</ul>



      
        <div class="blog-tags">
          
            <a
              href="https://anemology.cc/tags/hexo/"
              >hexo</a
            >&nbsp;
          
            <a
              href="https://anemology.cc/tags/next/"
              >next</a
            >&nbsp;
          
        </div>
      

      
        <ul class="bottomnav"><li class="next"><a href="/post/telegram-firstbot-using-nodejs/"
          >第一個 Telegram Bot<span>&nbsp;>></span></a
        ></li></ul>

      
    </article>
    
    
      

    
  </div>

    <footer>
  

<div class="social-icons">
  

  
</div>


  
  <div class="container">
    <p class="credits copyright">
      <a href="https://anemology.cc/about">anemology</a>
      &nbsp;&copy;
      2020
      
        &nbsp;/&nbsp;
        <a href="https://anemology.cc/">翱翔在空中</a>
      
      &nbsp;&ndash;&nbsp;
      <em class="fas fa-moon" id="dark-mode-toggle"></em>
    </p>

    <p class="credits theme-by">
      Powered By <a href="https://gohugo.io">Hugo</a>&nbsp;
      Theme
      <a href="https://github.com/matsuyoshi30/harbor">Harbor</a>
    </p>
  </div>
</footer>

  </body>
</html>
